<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ed1d24">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="Marvel filmlerini ve dizilerini takip edin">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="./manifest.json">
    <title>Marvel Ä°zleme Takibi</title>
    
    <style>
        /* ========== CSS VARIABLES ========== */
        :root {
            --primary-bg: #0f1419;
            --secondary-bg: #1a1f29;
            --card-bg: #1e2430;
            --accent-red: #e50914;
            --movie-color: #3b82f6;
            --series-color: #a855f7;
            --text-primary: #ffffff;
            --text-secondary: #9ca3af;
            --border-color: #2d3748;
            --success-color: #10b981;
            --gradient-start: #667eea;
            --gradient-end: #764ba2;
        }

        /* ========== RESET & BASE ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a1f29 100%);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            padding-bottom: 2rem;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(102, 126, 234, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(168, 85, 247, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* ========== HEADER ========== */
        .header {
            background: rgba(15, 20, 25, 0.95);
            backdrop-filter: blur(20px);
            padding: 1.5rem 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }

        .header-title {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        /* ========== NEXT TO WATCH ========== */
        .next-watch {
            margin: 1.5rem 1rem 0;
            padding: 0;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 1;
        }

        .next-watch-header {
            padding: 1rem 1.5rem;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .next-watch-title {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .next-watch-content {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            align-items: center;
        }

        .next-watch-poster {
            width: 80px;
            height: 120px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .next-watch-poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .next-watch-info h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 600;
        }

        .next-watch-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* ========== PROGRESS SECTION ========== */
        .progress-section {
            background: rgba(30, 36, 48, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            margin: 1rem 1rem 0;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 1;
        }

        .progress-stats {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 1.5rem;
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            color: var(--text-primary);
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 0.3rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 500;
        }

        .progress-bar-container {
            background: rgba(0, 0, 0, 0.3);
            height: 8px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 20px;
            position: relative;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        .progress-percentage {
            text-align: center;
            margin-top: 0.8rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        /* ========== FILTERS ========== */
        .filters {
            padding: 1.5rem;
            background: rgba(30, 36, 48, 0.6);
            backdrop-filter: blur(10px);
            margin: 1rem 1rem 0;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 1;
        }

        .filter-group {
            margin-bottom: 1.2rem;
        }

        .filter-group:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.8rem;
            display: block;
            letter-spacing: 0.1em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .filter-buttons {
            display: flex;
            gap: 0.6rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.7rem 1.2rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: none;
            letter-spacing: 0;
            font-family: inherit;
            border-radius: 8px;
        }

        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .phase-select {
            width: 100%;
            padding: 0.9rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.9rem;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s;
        }

        .phase-select:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .phase-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .action-buttons {
            display: flex;
            gap: 0.6rem;
            margin-top: 1.2rem;
            flex-wrap: wrap;
        }

        .action-btn {
            flex: 1;
            min-width: 130px;
            padding: 0.9rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: none;
            font-family: inherit;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        .action-btn.danger {
            border-color: rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        .action-btn.danger:hover {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.5);
        }

        /* ========== CONTENT LIST ========== */
        .content-list {
            padding: 0 1rem;
            margin-top: 1rem;
            position: relative;
            z-index: 1;
        }

        .content-card {
            background: rgba(30, 36, 48, 0.6);
            backdrop-filter: blur(10px);
            margin-bottom: 1rem;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideIn 0.4s ease-out backwards;
        }

        .content-card.movie {
            border-left: 3px solid var(--movie-color);
        }

        .content-card.series {
            border-left: 3px solid var(--series-color);
        }

        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateY(20px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }

        .content-card:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
            transform: translateY(-4px);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .content-card.watched {
            opacity: 0.5;
        }

        .content-card.watched:hover {
            opacity: 1;
        }

        .card-header {
            display: flex;
            gap: 1rem;
            padding: 1.2rem;
            cursor: pointer;
            position: relative;
        }

        .poster {
            width: 100px;
            height: 150px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform 0.3s;
        }

        .content-card:hover .poster img {
            transform: scale(1.08);
        }

        .poster.loading {
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(168, 85, 247, 0.2) 100%);
        }

        .poster.loading::after {
            content: 'M';
            font-weight: 900;
            color: rgba(255, 255, 255, 0.2);
            font-size: 3rem;
        }

        .card-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-width: 0;
        }

        .card-title {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            line-height: 1.3;
            font-weight: 600;
            color: var(--text-primary);
        }

        .card-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.6rem;
        }

        .tag {
            padding: 0.35rem 0.8rem;
            font-size: 0.7rem;
            font-weight: 500;
            letter-spacing: 0.02em;
            border-radius: 6px;
        }

        .tag-type {
            background: rgba(59, 130, 246, 0.15);
            color: var(--movie-color);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .tag-type.series {
            background: rgba(168, 85, 247, 0.15);
            color: var(--series-color);
            border: 1px solid rgba(168, 85, 247, 0.3);
        }

        .tag-phase {
            background: rgba(156, 163, 175, 0.15);
            color: var(--text-secondary);
            border: 1px solid rgba(156, 163, 175, 0.2);
        }

        .tag-year {
            background: rgba(156, 163, 175, 0.1);
            color: var(--text-secondary);
            border: 1px solid rgba(156, 163, 175, 0.15);
        }

        .tag-family {
            background: rgba(16, 185, 129, 0.15);
            color: var(--success-color);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .checkbox-container {
            position: absolute;
            top: 1.2rem;
            right: 1.2rem;
        }

        .watched-checkbox {
            width: 28px;
            height: 28px;
            cursor: pointer;
            position: relative;
            appearance: none;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            transition: all 0.3s;
        }

        .watched-checkbox:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .watched-checkbox:checked {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
            box-shadow: 0 0 16px rgba(102, 126, 234, 0.5);
        }

        .watched-checkbox:checked::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1rem;
            font-weight: 700;
        }

        .card-description {
            padding: 0 1.2rem 1.2rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.7;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            margin-top: 1rem;
            display: none;
            animation: expandDown 0.3s ease-out;
            font-weight: normal;
        }

        @keyframes expandDown {
            from {
                opacity: 0;
                padding-top: 0;
            }
            to {
                opacity: 1;
                padding-top: 1.2rem;
            }
        }

        .card-description.show {
            display: block;
        }

        /* ========== INSTALL PROMPT ========== */
        .install-prompt {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            background: rgba(30, 36, 48, 0.95);
            backdrop-filter: blur(20px);
            padding: 1.5rem;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            animation: slideUp 0.5s ease-out;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
        }

        @keyframes slideUp {
            from {
                transform: translateY(150%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .install-prompt h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .install-prompt p {
            font-size: 0.9rem;
            margin-bottom: 1rem;
            color: var(--text-secondary);
            font-weight: normal;
        }

        .install-buttons {
            display: flex;
            gap: 0.6rem;
        }

        .install-btn {
            flex: 1;
            padding: 0.9rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            text-transform: none;
            transition: all 0.3s;
            font-family: inherit;
        }

        .install-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .install-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .install-btn.secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-secondary);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .install-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        /* ========== EMPTY STATE ========== */
        .empty-state {
            text-align: center;
            padding: 4rem 1rem;
            color: var(--text-secondary);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 600;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 480px) {
            .header-title {
                font-size: 1.4rem;
            }
            
            .stat-number {
                font-size: 2rem;
            }
            
            .filter-btn {
                font-size: 0.8rem;
                padding: 0.6rem 1rem;
            }
            
            .poster {
                width: 80px;
                height: 120px;
            }
            
            .card-title {
                font-size: 1rem;
            }

            .action-btn {
                min-width: 100px;
                font-size: 0.75rem;
            }

            .next-watch-poster {
                width: 60px;
                height: 90px;
            }

            .next-watch-content {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <h1 class="header-title">MARVEL Ä°ZLEME TAKÄ°BÄ°</h1>
    </header>

    <!-- Progress Section -->
    <div class="progress-section">
        <div class="progress-stats">
            <div class="stat-item">
                <div class="stat-number" id="watchedCount">0</div>
                <div class="stat-label">Ä°zlendi</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">Toplam</div>
            </div>
        </div>
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-percentage" id="progressPercentage">0%</div>
    </div>

    <!-- Next to Watch -->
    <div class="next-watch" id="nextWatch" style="display: none;">
        <div class="next-watch-header">
            <div class="next-watch-title">ðŸŽ¬ SÄ±rada Ä°zlemeniz Gereken</div>
        </div>
        <div class="next-watch-content">
            <div class="next-watch-poster" id="nextWatchPoster">
                <img src="" alt="" id="nextWatchPosterImg">
            </div>
            <div class="next-watch-info">
                <h3 id="nextWatchName"></h3>
                <div class="next-watch-meta" id="nextWatchMeta"></div>
            </div>
        </div>
    </div>

    <!-- Filters -->
    <div class="filters">
        <div class="filter-group">
            <label class="filter-label">TÃ¼r</label>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="type" data-value="all">TÃ¼mÃ¼</button>
                <button class="filter-btn" data-filter="type" data-value="movie">Filmler</button>
                <button class="filter-btn" data-filter="type" data-value="series">Diziler</button>
            </div>
        </div>

        <div class="filter-group">
            <label class="filter-label">Durum</label>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="status" data-value="all">TÃ¼mÃ¼</button>
                <button class="filter-btn" data-filter="status" data-value="watched">Ä°zlediklerim</button>
                <button class="filter-btn" data-filter="status" data-value="unwatched">Ä°zlemediklerim</button>
            </div>
        </div>

        <div class="filter-group">
            <label class="filter-label">Aile Uygun</label>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="family" data-value="all">TÃ¼mÃ¼</button>
                <button class="filter-btn" data-filter="family" data-value="yes">Aile Ä°Ã§in</button>
            </div>
        </div>

        <div class="filter-group">
            <label class="filter-label">Faz</label>
            <select class="phase-select" id="phaseFilter">
                <option value="all">TÃ¼m Fazlar</option>
                <option value="1">Faz 1</option>
                <option value="2">Faz 2</option>
                <option value="3">Faz 3</option>
                <option value="4">Faz 4</option>
                <option value="5">Faz 5</option>
                <option value="6">Faz 6</option>
            </select>
        </div>

        <div class="action-buttons">
            <button class="action-btn" id="clearFilters">Filtreleri Temizle</button>
            <button class="action-btn" id="markAllWatched">TÃ¼mÃ¼nÃ¼ Ä°ÅŸaretle</button>
            <button class="action-btn danger" id="resetData">Verileri SÄ±fÄ±rla</button>
        </div>
    </div>

    <!-- Content List -->
    <div class="content-list" id="contentList"></div>

    <!-- Install Prompt -->
    <div class="install-prompt" id="installPrompt" style="display: none;">
        <h3>ðŸ“± ANA EKRANA EKLE</h3>
        <p>Bu uygulamayÄ± ana ekranÄ±na ekleyerek tam ekran Marvel deneyimi yaÅŸa!</p>
        <div class="install-buttons">
            <button class="install-btn primary" id="installBtn">EKLE</button>
            <button class="install-btn secondary" id="dismissInstall">KAPAT</button>
        </div>
    </div>

    <script>
        // ========== MARVEL CONTENT DATA ==========
        const marvelContent = [
            // Phase 1
            { id: 1, title: "Iron Man", type: "movie", year: 2008, phase: 1, chronologicalOrder: 3, isFamilyFriendly: true, description: "Tony Stark, kaÃ§Ä±rÄ±ldÄ±ktan sonra high-tech zÄ±rh yaratÄ±r ve Iron Man olur.", poster: "https://m.media-amazon.com/images/M/MV5BMTczNTI2ODUwOF5BMl5BanBnXkFtZTcwMTU0NTIzMw@@._V1_SX300.jpg" },
            { id: 2, title: "The Incredible Hulk", type: "movie", year: 2008, phase: 1, chronologicalOrder: 4, isFamilyFriendly: true, description: "Bruce Banner, Hulk'a dÃ¶nÃ¼ÅŸmesine sebep olan gamma radyasyonundan kurtulmaya Ã§alÄ±ÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMTUyNzk3MjA1OF5BMl5BanBnXkFtZTcwMTE1Njg2MQ@@._V1_SX300.jpg" },
            { id: 3, title: "Iron Man 2", type: "movie", year: 2010, phase: 1, chronologicalOrder: 5, isFamilyFriendly: true, description: "Tony Stark, hem Ã¶lÃ¼mcÃ¼l bir dÃ¼ÅŸmanla hem de kendi saÄŸlÄ±k sorunlarÄ±yla yÃ¼zleÅŸir.", poster: "https://m.media-amazon.com/images/M/MV5BMTM0MDgwNjMyMl5BMl5BanBnXkFtZTcwNTg3NzAzMw@@._V1_SX300.jpg" },
            { id: 4, title: "Thor", type: "movie", year: 2011, phase: 1, chronologicalOrder: 6, isFamilyFriendly: true, description: "Asgard'Ä±n gÃ¼Ã§lÃ¼ prensi Thor, DÃ¼nya'ya sÃ¼rgÃ¼n edilir ve alÃ§akgÃ¶nÃ¼llÃ¼lÃ¼k Ã¶ÄŸrenir.", poster: "https://m.media-amazon.com/images/M/MV5BOGE4NzU1YTAtNzA3Mi00ZTA2LTg2YmYtMDJmMThiMjlkYjg2XkEyXkFqcGdeQXVyNTgzMDMzMTg@._V1_SX300.jpg" },
            { id: 5, title: "Captain America: The First Avenger", type: "movie", year: 2011, phase: 1, chronologicalOrder: 1, isFamilyFriendly: true, description: "Steve Rogers, sÃ¼per asker Captain America olur ve Red Skull'a karÅŸÄ± savaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMTYzOTc2NzU3N15BMl5BanBnXkFtZTcwNjY3MDE3NQ@@._V1_SX300.jpg" },
            { id: 6, title: "The Avengers", type: "movie", year: 2012, phase: 1, chronologicalOrder: 7, isFamilyFriendly: true, description: "Earth's Mightiest Heroes, Loki ve Chitauri istilasÄ±na karÅŸÄ± bir araya gelir.", poster: "https://m.media-amazon.com/images/M/MV5BNDYxNjQyMjAtNTdiOS00NGYwLWFmNTAtNThmYjU5ZGI2YTI1XkEyXkFqcGdeQXVyMTMxODk2OTU@._V1_SX300.jpg" },
            
            // Phase 2
            { id: 7, title: "Iron Man 3", type: "movie", year: 2013, phase: 2, chronologicalOrder: 8, isFamilyFriendly: true, description: "Tony Stark, Mandarin'in saldÄ±rÄ±sÄ±ndan sonra PTSD ile baÅŸa Ã§Ä±kmaya Ã§alÄ±ÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMjE5MzcyNjk1M15BMl5BanBnXkFtZTcwMjQ4MjcxOQ@@._V1_SX300.jpg" },
            { id: 8, title: "Thor: The Dark World", type: "movie", year: 2013, phase: 2, chronologicalOrder: 9, isFamilyFriendly: true, description: "Thor, Malekith ve Dark Elves'e karÅŸÄ± dokuz diyarÄ± korumak iÃ§in savaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMTQyNzAwOTUxOF5BMl5BanBnXkFtZTcwMTE0OTc5OQ@@._V1_SX300.jpg" },
            { id: 9, title: "Captain America: The Winter Soldier", type: "movie", year: 2014, phase: 2, chronologicalOrder: 10, isFamilyFriendly: false, description: "Steve Rogers, SHIELD iÃ§indeki Hydra komplosuyla ve gizemli Winter Soldier ile yÃ¼zleÅŸir.", poster: "https://m.media-amazon.com/images/M/MV5BMzA2NDkwODAwM15BMl5BanBnXkFtZTgwODk5MTgzMTE@._V1_SX300.jpg" },
            { id: 10, title: "Guardians of the Galaxy", type: "movie", year: 2014, phase: 2, chronologicalOrder: 11, isFamilyFriendly: true, description: "Acayip uzay maceracÄ±larÄ±ndan oluÅŸan bir grup, galaksiyi korumak iÃ§in bir araya gelir.", poster: "https://m.media-amazon.com/images/M/MV5BZTkwZjU3MTctMGExMi00YjU5LTgwMTMtZmNiOWNmODk3MTZiXkEyXkFqcGdeQXVyNTAyODkwOQ@@._V1_SX300.jpg" },
            { id: 11, title: "Avengers: Age of Ultron", type: "movie", year: 2015, phase: 2, chronologicalOrder: 12, isFamilyFriendly: false, description: "Avengers, Tony Stark'Ä±n yarattÄ±ÄŸÄ± yapay zeka Ultron'un tehdidiyle karÅŸÄ±laÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMTM4OGJmNWMtOTM4Ni00NTE3LTg3MDItZmQxYjc4N2JhNmUxXkEyXkFqcGdeQXVyNTgzMDMzMTg@._V1_SX300.jpg" },
            { id: 12, title: "Ant-Man", type: "movie", year: 2015, phase: 2, chronologicalOrder: 13, isFamilyFriendly: true, description: "Scott Lang, Ant-Man kostÃ¼mÃ¼nÃ¼ giyerek dÃ¼nyayÄ± kurtarmak iÃ§in kÃ¼Ã§Ã¼lme gÃ¼cÃ¼nÃ¼ kullanÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMjM2NTQ5Mzc2M15BMl5BanBnXkFtZTgwNTcxMDI2NTE@._V1_SX300.jpg" },
            
            // Phase 3
            { id: 13, title: "Captain America: Civil War", type: "movie", year: 2016, phase: 3, chronologicalOrder: 14, isFamilyFriendly: false, description: "Avengers, Sokovia AnlaÅŸmasÄ± yÃ¼zÃ¼nden ikiye bÃ¶lÃ¼nÃ¼r.", poster: "https://m.media-amazon.com/images/M/MV5BMjQ0MTgyNjAxMV5BMl5BanBnXkFtZTgwNjUzMDkyODE@._V1_SX300.jpg" },
            { id: 14, title: "Doctor Strange", type: "movie", year: 2016, phase: 3, chronologicalOrder: 15, isFamilyFriendly: true, description: "Cerrah Stephen Strange, gizemli sanatlarÄ± Ã¶ÄŸrenerek bÃ¼yÃ¼cÃ¼ olur.", poster: "https://m.media-amazon.com/images/M/MV5BNjgwNzAzNjk1Nl5BMl5BanBnXkFtZTgwMzQ2NjI1OTE@._V1_SX300.jpg" },
            { id: 15, title: "Guardians of the Galaxy Vol. 2", type: "movie", year: 2017, phase: 3, chronologicalOrder: 16, isFamilyFriendly: true, description: "Star-Lord, gerÃ§ek babasÄ±yla tanÄ±ÅŸÄ±r ve ekibiyle birlikte yeni tehlikelere karÅŸÄ± koyar.", poster: "https://m.media-amazon.com/images/M/MV5BNjM0NTc0NzItM2FlYS00YzEwLWE0YmUtNTA2ZWIzODc2OTgxXkEyXkFqcGdeQXVyNTgwNzIyNzg@._V1_SX300.jpg" },
            { id: 16, title: "Spider-Man: Homecoming", type: "movie", year: 2017, phase: 3, chronologicalOrder: 17, isFamilyFriendly: true, description: "Peter Parker, lise hayatÄ±nÄ± sÃ¼rdÃ¼rÃ¼rken Vulture ile savaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BNTk4ODQ1MzgzNl5BMl5BanBnXkFtZTgwMTMyMzM4MTI@._V1_SX300.jpg" },
            { id: 17, title: "Thor: Ragnarok", type: "movie", year: 2017, phase: 3, chronologicalOrder: 18, isFamilyFriendly: false, description: "Thor, Hela'ya karÅŸÄ± savaÅŸÄ±rken Sakaar gezegeninde gladyatÃ¶r olarak tutsak dÃ¼ÅŸer.", poster: "https://m.media-amazon.com/images/M/MV5BMjMyNDkzMzI1OF5BMl5BanBnXkFtZTgwODcxODg5MjI@._V1_SX300.jpg" },
            { id: 18, title: "Black Panther", type: "movie", year: 2018, phase: 3, chronologicalOrder: 19, isFamilyFriendly: true, description: "T'Challa, Wakanda'nÄ±n kralÄ± olarak tahtÄ±nÄ± ve Ã¼lkesini korumak iÃ§in savaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMTg1MTY2MjYzNV5BMl5BanBnXkFtZTgwMTc4NTMwNDI@._V1_SX300.jpg" },
            { id: 19, title: "Avengers: Infinity War", type: "movie", year: 2018, phase: 3, chronologicalOrder: 20, isFamilyFriendly: false, description: "Avengers ve mÃ¼ttefikleri, tÃ¼m evreni yok etmeye kararlÄ± Thanos'a karÅŸÄ± savaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMjMxNjY2MDU1OV5BMl5BanBnXkFtZTgwNzY1MTUwNTM@._V1_SX300.jpg" },
            { id: 20, title: "Ant-Man and the Wasp", type: "movie", year: 2018, phase: 3, chronologicalOrder: 21, isFamilyFriendly: true, description: "Scott Lang ve Hope van Dyne, Quantum Realm'de yeni bir tehlikeye karÅŸÄ± savaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BYjcyYTk0N2YtMzc4ZC00Y2E0LWFkNDgtNjE1MzZmMGE1YjY1XkEyXkFqcGdeQXVyMTMxODk2OTU@._V1_SX300.jpg" },
            { id: 21, title: "Captain Marvel", type: "movie", year: 2019, phase: 3, chronologicalOrder: 2, isFamilyFriendly: true, description: "Carol Danvers, evrenin en gÃ¼Ã§lÃ¼ kahramanlarÄ±ndan biri olur.", poster: "https://m.media-amazon.com/images/M/MV5BMTE0YWFmOTMtYTU2ZS00ZTIxLWE3OTEtYTNiYzBkZjViZThiXkEyXkFqcGdeQXVyODMzMzQ4OTI@._V1_SX300.jpg" },
            { id: 22, title: "Avengers: Endgame", type: "movie", year: 2019, phase: 3, chronologicalOrder: 22, isFamilyFriendly: false, description: "Hayatta kalan Avengers, Thanos'u yenip kayÄ±plarÄ± geri getirmek iÃ§in bir son ÅŸans dener.", poster: "https://m.media-amazon.com/images/M/MV5BMTc5MDE2ODcwNV5BMl5BanBnXkFtZTgwMzI2NzQ2NzM@._V1_SX300.jpg" },
            { id: 23, title: "Spider-Man: Far From Home", type: "movie", year: 2019, phase: 3, chronologicalOrder: 23, isFamilyFriendly: true, description: "Peter Parker, Avrupa tatilinde Mysterio ile karÅŸÄ±laÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMGZlNTY1ZWUtYTMzNC00ZjUyLWE0MjQtMTMxN2E3ODYxMWVmXkEyXkFqcGdeQXVyMDM2NDM2MQ@@._V1_SX300.jpg" },
            
            // Phase 4
            { id: 24, title: "WandaVision", type: "series", year: 2021, phase: 4, chronologicalOrder: 24, isFamilyFriendly: false, description: "Wanda ve Vision, tuhaf bir banliyÃ¶ kasabasÄ±nda sitcom hayatÄ± yaÅŸarlar.", poster: "https://m.media-amazon.com/images/M/MV5BZGEwYmMwZmMtMTQ3MS00YWNhLWEwMDgtYzUwMDNkMTE0NTNhXkEyXkFqcGdeQXVyMTI5MzA5MjA1._V1_SX300.jpg" },
            { id: 25, title: "The Falcon and The Winter Soldier", type: "series", year: 2021, phase: 4, chronologicalOrder: 25, isFamilyFriendly: false, description: "Sam Wilson ve Bucky Barnes, yeni tehditlerle yÃ¼zleÅŸir.", poster: "https://m.media-amazon.com/images/M/MV5BODNiODVmYjItM2MyMC00ZWQyLTgyMGYtNzJjMmVmZTY2OTJjXkEyXkFqcGdeQXVyNzk3NDUzNTc@._V1_SX300.jpg" },
            { id: 26, title: "Loki", type: "series", year: 2021, phase: 4, chronologicalOrder: 26, isFamilyFriendly: false, description: "Loki, Time Variance Authority tarafÄ±ndan yakalandÄ±ktan sonra zaman Ã§izelgesini dÃ¼zeltmeye Ã§alÄ±ÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BYjQ0NmJhMDItMmU0MC00MzY5LWE3YjAtNWM0ODYwMjNkMGMzXkEyXkFqcGdeQXVyODk4OTc3MTY@._V1_SX300.jpg" },
            { id: 27, title: "Black Widow", type: "movie", year: 2021, phase: 4, chronologicalOrder: 27, isFamilyFriendly: false, description: "Natasha Romanoff, kara geÃ§miÅŸiyle yÃ¼zleÅŸir.", poster: "https://m.media-amazon.com/images/M/MV5BNjRmNDI5MjMtMmFhZi00YzcwLWI4ZGItMGI2MjI0N2Q3YmIwXkEyXkFqcGdeQXVyMTkxNjUyNQ@@._V1_SX300.jpg" },
            { id: 28, title: "What If...?", type: "series", year: 2021, phase: 4, chronologicalOrder: 28, isFamilyFriendly: true, description: "MCU'nun alternatif gerÃ§ekliklerdeki farklÄ± versiyonlarÄ± keÅŸfedilir.", poster: "https://m.media-amazon.com/images/M/MV5BYWMyNjdmODgtZDMzNi00MzJmLWJmYTEtNjUwNjI0MmI4NmVlXkEyXkFqcGdeQXVyMTM1MTE1NDMx._V1_SX300.jpg" },
            { id: 29, title: "Shang-Chi and the Legend of the Ten Rings", type: "movie", year: 2021, phase: 4, chronologicalOrder: 29, isFamilyFriendly: true, description: "Shang-Chi, On Halkalar Ã¶rgÃ¼tÃ¼yle ve babasÄ±yla yÃ¼zleÅŸir.", poster: "https://m.media-amazon.com/images/M/MV5BNTliYjlkNDQtMjFlNS00NjgzLWFmMWEtYmM2Mzc2Zjg3ZjEyXkEyXkFqcGdeQXVyMTkxNjUyNQ@@._V1_SX300.jpg" },
            { id: 30, title: "Eternals", type: "movie", year: 2021, phase: 4, chronologicalOrder: 30, isFamilyFriendly: true, description: "Ã–lÃ¼msÃ¼z Eternals, binlerce yÄ±ldÄ±r gizlendikten sonra Deviants'a karÅŸÄ± birleÅŸir.", poster: "https://m.media-amazon.com/images/M/MV5BYzJlYmFiMmQtZmY4MS00ODg2LWFmZjMtNjJlNWFlNDY1YzY3XkEyXkFqcGdeQXVyMTEyMjM2NDc2._V1_SX300.jpg" },
            { id: 31, title: "Hawkeye", type: "series", year: 2021, phase: 4, chronologicalOrder: 31, isFamilyFriendly: true, description: "Clint Barton, Kate Bishop'u eÄŸitirken geÃ§miÅŸiyle hesaplaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BZDhlMzMwMjEtNzMzMy00MmQ1LWI0OTItODE0ZGI2MjkwNmE1XkEyXkFqcGdeQXVyMTEyMjM2NDc2._V1_SX300.jpg" },
            { id: 32, title: "Spider-Man: No Way Home", type: "movie", year: 2021, phase: 4, chronologicalOrder: 32, isFamilyFriendly: true, description: "Peter Parker, Doctor Strange'den yardÄ±m ister ve multiverse kapÄ±larÄ± aÃ§Ä±lÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BZWMyYzFjYTYtNTRjYi00OGExLWE2YzgtOGRmYjAxZTU3NzBiXkEyXkFqcGdeQXVyMzQ0MzA0NTM@._V1_SX300.jpg" },
            { id: 33, title: "Moon Knight", type: "series", year: 2022, phase: 4, chronologicalOrder: 33, isFamilyFriendly: false, description: "Marc Spector, dissociative identity disorder ile baÅŸa Ã§Ä±karken MÄ±sÄ±r tanrÄ±larÄ±nÄ±n gÃ¼cÃ¼nÃ¼ kullanÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BYTc5OWNhYjktMThlOS00ODUxLTgwNDQtZjdjYjkyM2IwZTZlXkEyXkFqcGdeQXVyNTA3MTU2MjE@._V1_SX300.jpg" },
            { id: 34, title: "Doctor Strange in the Multiverse of Madness", type: "movie", year: 2022, phase: 4, chronologicalOrder: 34, isFamilyFriendly: false, description: "Doctor Strange, multiverse'Ã¼ keÅŸfederken bÃ¼yÃ¼k tehditlerle karÅŸÄ±laÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BNWM0ZGJlMzMtZmYwMi00NzI3LTgzMzMtNjMzNjliNDRmZmFlXkEyXkFqcGdeQXVyMTM1MTE1NDMx._V1_SX300.jpg" },
            { id: 35, title: "Ms. Marvel", type: "series", year: 2022, phase: 4, chronologicalOrder: 35, isFamilyFriendly: true, description: "Kamala Khan, sÃ¼per gÃ¼Ã§ler kazanÄ±r ve ailesinin geÃ§miÅŸini keÅŸfeder.", poster: "https://m.media-amazon.com/images/M/MV5BMTg2Mzk2NjU0OF5BMl5BanBnXkFtZTgwMTY0MjQzNjM@._V1_SX300.jpg" },
            { id: 36, title: "Thor: Love and Thunder", type: "movie", year: 2022, phase: 4, chronologicalOrder: 36, isFamilyFriendly: true, description: "Thor, Gorr the God Butcher'a karÅŸÄ± savaÅŸÄ±rken eski sevgilisi Jane Foster ile yeniden bir araya gelir.", poster: "https://m.media-amazon.com/images/M/MV5BYmMxZWRiMTgtZjM0Ny00NDQxLWIxYWQtZDdlNDNkOTEzYTdlXkEyXkFqcGdeQXVyMTkxNjUyNQ@@._V1_SX300.jpg" },
            { id: 37, title: "She-Hulk: Attorney at Law", type: "series", year: 2022, phase: 4, chronologicalOrder: 37, isFamilyFriendly: true, description: "Jennifer Walters, She-Hulk gÃ¼cÃ¼yle avukatlÄ±k yapar.", poster: "https://m.media-amazon.com/images/M/MV5BYjJlMDY5ZTQtZGU5MS00ZTFiLWFlNWItMGI5MzJlZTk0NzY5XkEyXkFqcGdeQXVyMTUzMTg2ODkz._V1_SX300.jpg" },
            { id: 38, title: "Werewolf by Night", type: "movie", year: 2022, phase: 4, chronologicalOrder: 38, isFamilyFriendly: false, description: "Korku temalÄ± Ã¶zel bir Marvel hikayesi.", poster: "https://m.media-amazon.com/images/M/MV5BYjk0MTgzNTAtYWJjNS00ZDExLTgzZjMtNWY2MjY4ZmQzOWU0XkEyXkFqcGdeQXVyMTEyMjM2NDc2._V1_SX300.jpg" },
            { id: 39, title: "Black Panther: Wakanda Forever", type: "movie", year: 2022, phase: 4, chronologicalOrder: 39, isFamilyFriendly: false, description: "Wakanda, Kral T'Challa'nÄ±n Ã¶lÃ¼mÃ¼nÃ¼n ardÄ±ndan Namor'un tehdidiyle yÃ¼zleÅŸir.", poster: "https://m.media-amazon.com/images/M/MV5BNTM4NjIxNmEtYWE5NS00NDczLTkyNWQtYThhNmQyZGQzMjM0XkEyXkFqcGdeQXVyODE5NzE3OTE@._V1_SX300.jpg" },
            
            // Phase 5
            { id: 40, title: "Ant-Man and the Wasp: Quantumania", type: "movie", year: 2023, phase: 5, chronologicalOrder: 40, isFamilyFriendly: true, description: "Scott Lang ve ailesi Quantum Realm'de Kang the Conqueror ile karÅŸÄ±laÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BODZhNzlmOGItMWUyYS00Y2Q5LWFlNzMtM2I2NDFkM2ZkYmE1XkEyXkFqcGdeQXVyMTU5OTA4NTIz._V1_SX300.jpg" },
            { id: 41, title: "Guardians of the Galaxy Vol. 3", type: "movie", year: 2023, phase: 5, chronologicalOrder: 41, isFamilyFriendly: false, description: "Guardians, Rocket'Ä±n geÃ§miÅŸini keÅŸfederken High Evolutionary'ye karÅŸÄ± savaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BMDgxOTdjMzYtZGQxMS00ZTAzLWI4Y2UtMTQzN2VlYjYyZWRiXkEyXkFqcGdeQXVyMTkxNjUyNQ@@._V1_SX300.jpg" },
            { id: 42, title: "Secret Invasion", type: "series", year: 2023, phase: 5, chronologicalOrder: 42, isFamilyFriendly: false, description: "Nick Fury, DÃ¼nya'yÄ± ele geÃ§irmeye Ã§alÄ±ÅŸan Skrull'lara karÅŸÄ± savaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BY2EzN2U0MDQtNGRlOS00YWZlLWIyOTgtM2VlOTYyODM5NTA2XkEyXkFqcGdeQXVyMTUzMTg2ODkz._V1_SX300.jpg" },
            { id: 43, title: "The Marvels", type: "movie", year: 2023, phase: 5, chronologicalOrder: 43, isFamilyFriendly: true, description: "Carol Danvers, Kamala Khan ve Monica Rambeau, gÃ¼Ã§leri birbirine karÄ±ÅŸtÄ±ÄŸÄ±nda bir araya gelir.", poster: "https://m.media-amazon.com/images/M/MV5BM2U2YWU5NWMtOGI2Ni00MGMwLWFkNjItMjgyZWMxNjllNTMzXkEyXkFqcGdeQXVyMDM2NDM2MQ@@._V1_SX300.jpg" },
            { id: 44, title: "Loki Season 2", type: "series", year: 2023, phase: 5, chronologicalOrder: 44, isFamilyFriendly: false, description: "Loki, zaman Ã§izelgesini korumak iÃ§in TVA'da Ã§alÄ±ÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BZTQ5ZWQ1NjQtODI1Yi00MGZkLTk0YTYtNmJmZTg2NWE4YmU1XkEyXkFqcGdeQXVyMTUzMTg2ODkz._V1_SX300.jpg" },
            { id: 45, title: "Echo", type: "series", year: 2024, phase: 5, chronologicalOrder: 45, isFamilyFriendly: false, description: "Maya Lopez, geÃ§miÅŸiyle ve Kingpin ile hesaplaÅŸÄ±r.", poster: "https://m.media-amazon.com/images/M/MV5BYzJkM2Y0ZGQtZDYzMC00NmE3LWE5NjgtMzBiMjkyMWZhMGVkXkEyXkFqcGdeQXVyMTUzMTg2ODkz._V1_SX300.jpg" },
            { id: 46, title: "Deadpool & Wolverine", type: "movie", year: 2024, phase: 5, chronologicalOrder: 46, isFamilyFriendly: false, description: "Deadpool ve Wolverine, multiverse maceralarÄ±nda bir araya gelir.", poster: "https://m.media-amazon.com/images/M/MV5BZTk3ZjY1MjgtOWRkZi00YjZjLWFlZDAtY2I5YzFjMjRhMjQzXkEyXkFqcGdeQXVyMTUzMTg2ODkz._V1_SX300.jpg" },
            { id: 47, title: "Agatha All Along", type: "series", year: 2024, phase: 5, chronologicalOrder: 47, isFamilyFriendly: false, description: "Agatha Harkness, gÃ¼Ã§lerini geri kazanmak iÃ§in Witches' Road'a gider.", poster: "https://m.media-amazon.com/images/M/MV5BYmU5MTdlZWQtMjQ1OC00OWQ2LWE4NzQtMTg5NmY3NTBlNTA0XkEyXkFqcGdeQXVyMTY3ODkyNDkz._V1_SX300.jpg" }
        ];

        // ========== STATE MANAGEMENT ==========
        let currentFilters = {
            type: 'all',
            status: 'all',
            family: 'all',
            phase: 'all'
        };

        let watchedItems = JSON.parse(localStorage.getItem('marvelWatched')) || [];

        // ========== INITIALIZATION ==========
        function init() {
            // Merge watched status into content
            marvelContent.forEach(item => {
                item.watched = watchedItems.includes(item.id);
            });

            // Setup event listeners
            setupEventListeners();
            
            // Render initial content
            renderContent();
            updateProgress();
            updateNextWatch();

            // Show install prompt if not dismissed
            showInstallPrompt();

            // Register service worker
            registerServiceWorker();
        }

        // ========== EVENT LISTENERS ==========
        function setupEventListeners() {
            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', handleFilterClick);
            });

            // Phase select
            document.getElementById('phaseFilter').addEventListener('change', handlePhaseChange);

            // Action buttons
            document.getElementById('clearFilters').addEventListener('click', clearFilters);
            document.getElementById('markAllWatched').addEventListener('click', markAllWatched);
            document.getElementById('resetData').addEventListener('click', resetData);

            // Install prompt
            document.getElementById('installBtn').addEventListener('click', handleInstall);
            document.getElementById('dismissInstall').addEventListener('click', dismissInstall);
        }

        // ========== FILTER HANDLING ==========
        function handleFilterClick(e) {
            const btn = e.target;
            const filterType = btn.dataset.filter;
            const filterValue = btn.dataset.value;

            // Update active state
            document.querySelectorAll(`[data-filter="${filterType}"]`).forEach(b => {
                b.classList.remove('active');
            });
            btn.classList.add('active');

            // Update filter state
            currentFilters[filterType] = filterValue;

            // Re-render
            renderContent();
        }

        function handlePhaseChange(e) {
            currentFilters.phase = e.target.value;
            renderContent();
        }

        function clearFilters() {
            currentFilters = {
                type: 'all',
                status: 'all',
                family: 'all',
                phase: 'all'
            };

            // Reset UI
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.value === 'all') {
                    btn.classList.add('active');
                }
            });
            document.getElementById('phaseFilter').value = 'all';

            renderContent();
        }

        // ========== CONTENT RENDERING ==========
        function renderContent() {
            const container = document.getElementById('contentList');
            const filtered = getFilteredContent();

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>HÄ°Ã‡BÄ°R SONUÃ‡ BULUNAMADI</h3>
                        <p>Filtreleri deÄŸiÅŸtirmeyi deneyin</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map((item, index) => `
                <div class="content-card ${item.watched ? 'watched' : ''} ${item.type}" style="animation-delay: ${index * 0.05}s">
                    <div class="card-header" onclick="toggleDescription(${item.id})">
                        <div class="poster">
                            <img src="${item.poster}" alt="${item.title}" loading="lazy" onerror="this.parentElement.classList.add('loading'); this.style.display='none';">
                        </div>
                        <div class="card-info">
                            <div class="card-title">${item.title}</div>
                            <div class="card-meta">
                                <span class="tag tag-type ${item.type}">${item.type === 'movie' ? 'Film' : 'Dizi'}</span>
                                <span class="tag tag-phase">Faz ${item.phase}</span>
                                <span class="tag tag-year">${item.year}</span>
                                ${item.isFamilyFriendly ? '<span class="tag tag-family">Aile</span>' : ''}
                            </div>
                        </div>
                        <div class="checkbox-container">
                            <input 
                                type="checkbox" 
                                class="watched-checkbox" 
                                ${item.watched ? 'checked' : ''}
                                onclick="event.stopPropagation(); toggleWatched(${item.id})"
                            >
                        </div>
                    </div>
                    <div class="card-description" id="desc-${item.id}">
                        ${item.description}
                    </div>
                </div>
            `).join('');
        }

        function getFilteredContent() {
            return marvelContent
                .filter(item => {
                    // Type filter
                    if (currentFilters.type !== 'all' && item.type !== currentFilters.type) {
                        return false;
                    }

                    // Status filter
                    if (currentFilters.status === 'watched' && !item.watched) {
                        return false;
                    }
                    if (currentFilters.status === 'unwatched' && item.watched) {
                        return false;
                    }

                    // Family filter
                    if (currentFilters.family === 'yes' && !item.isFamilyFriendly) {
                        return false;
                    }

                    // Phase filter
                    if (currentFilters.phase !== 'all' && item.phase !== parseInt(currentFilters.phase)) {
                        return false;
                    }

                    return true;
                })
                .sort((a, b) => {
                    // YayÄ±n sÄ±rasÄ±na gÃ¶re (Ã§Ä±kÄ±ÅŸ yÄ±lÄ±)
                    if (a.year !== b.year) {
                        return a.year - b.year;
                    }
                    return a.id - b.id;
                });
        }

        // ========== WATCHED TOGGLE ==========
        function toggleWatched(id) {
            const item = marvelContent.find(i => i.id === id);
            item.watched = !item.watched;

            if (item.watched) {
                watchedItems.push(id);
            } else {
                watchedItems = watchedItems.filter(i => i !== id);
            }

            localStorage.setItem('marvelWatched', JSON.stringify(watchedItems));
            updateProgress();
            updateNextWatch();
        }

        function toggleDescription(id) {
            const desc = document.getElementById(`desc-${id}`);
            desc.classList.toggle('show');
        }

        // ========== PROGRESS UPDATE ==========
        function updateProgress() {
            const total = marvelContent.length;
            const watched = marvelContent.filter(i => i.watched).length;
            const percentage = Math.round((watched / total) * 100);

            document.getElementById('watchedCount').textContent = watched;
            document.getElementById('totalCount').textContent = total;
            document.getElementById('progressBar').style.width = percentage + '%';
            document.getElementById('progressPercentage').textContent = percentage + '%';
        }

        // ========== NEXT TO WATCH ==========
        function updateNextWatch() {
            // YayÄ±n sÄ±rasÄ±na gÃ¶re bir sonraki izlenmemiÅŸ iÃ§erik
            const nextItem = marvelContent
                .filter(i => !i.watched)
                .sort((a, b) => {
                    if (a.year !== b.year) return a.year - b.year;
                    return a.id - b.id;
                })[0];

            const nextWatch = document.getElementById('nextWatch');
            
            if (nextItem) {
                document.getElementById('nextWatchName').textContent = nextItem.title;
                document.getElementById('nextWatchMeta').textContent = 
                    `${nextItem.type === 'movie' ? 'Film' : 'Dizi'} â€¢ ${nextItem.year} â€¢ Faz ${nextItem.phase}`;
                document.getElementById('nextWatchPosterImg').src = nextItem.poster;
                document.getElementById('nextWatchPosterImg').alt = nextItem.title;
                nextWatch.style.display = 'block';
            } else {
                nextWatch.style.display = 'none';
            }
        }

        // ========== ACTION BUTTONS ==========
        function markAllWatched() {
            const filtered = getFilteredContent();
            if (confirm(`${filtered.length} iÃ§eriÄŸin tÃ¼mÃ¼nÃ¼ izledim olarak iÅŸaretlemek istiyor musunuz?`)) {
                filtered.forEach(item => {
                    item.watched = true;
                    if (!watchedItems.includes(item.id)) {
                        watchedItems.push(item.id);
                    }
                });
                localStorage.setItem('marvelWatched', JSON.stringify(watchedItems));
                renderContent();
                updateProgress();
                updateNextWatch();
            }
        }

        function resetData() {
            if (confirm('TÃ¼m izleme verilerini silmek istediÄŸinize emin misiniz? Bu iÅŸlem geri alÄ±namaz!')) {
                localStorage.removeItem('marvelWatched');
                watchedItems = [];
                marvelContent.forEach(item => item.watched = false);
                renderContent();
                updateProgress();
                updateNextWatch();
            }
        }

        // ========== PWA INSTALL ==========
        let deferredPrompt;

        function showInstallPrompt() {
            const dismissed = localStorage.getItem('installPromptDismissed');
            if (!dismissed) {
                setTimeout(() => {
                    document.getElementById('installPrompt').style.display = 'block';
                }, 3000);
            }
        }

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });

        function handleInstall() {
            const installPrompt = document.getElementById('installPrompt');
            installPrompt.style.display = 'none';

            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    deferredPrompt = null;
                });
            } else {
                // iOS iÃ§in manuel talimat
                alert('Safari\'de, paylaÅŸ butonuna tÄ±klayÄ±p "Ana Ekrana Ekle" seÃ§eneÄŸini kullanabilirsiniz.');
            }
        }

        function dismissInstall() {
            document.getElementById('installPrompt').style.display = 'none';
            localStorage.setItem('installPromptDismissed', 'true');
        }

        // ========== SERVICE WORKER ==========
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker kayÄ±tlÄ±'))
                    .catch(err => console.log('Service Worker hatasÄ±:', err));
            }
        }

        // Create Apple touch icon
        const appleTouchIcon = document.createElement('link');
        appleTouchIcon.rel = 'apple-touch-icon';
        appleTouchIcon.href = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'%3E%3Crect fill='%23ed1d24' width='192' height='192'/%3E%3Ctext x='96' y='140' font-size='120' font-weight='900' text-anchor='middle' fill='white' font-family='Arial Black'%3EM%3C/text%3E%3C/svg%3E";
        document.head.appendChild(appleTouchIcon);

        // ========== START APP ==========
        init();
    </script>
</body>
</html>